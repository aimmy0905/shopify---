# 提现处理上传功能使用说明

## 功能说明

在提现管理页面的处理对话框中，已经成功添加了付款凭证上传功能。该功能只有在选择"处理完成"状态时才会显示。

## 使用步骤

### 1. 打开提现处理对话框
- 在提现管理页面，点击任意提现记录的"处理"按钮
- 系统会打开"提现处理"对话框

### 2. 选择处理状态
- **重要：必须选择"处理完成"状态**
- 只有选择"处理完成"时，才会显示以下字段：
  - 交易ID（必填）
  - 付款凭证上传
  
### 3. 上传付款凭证
当选择"处理完成"状态后，会显示：
- **交易ID输入框**：必须填写银行或支付平台的交易ID
- **付款凭证上传区域**：
  - 点击上传区域选择图片文件
  - 支持 JPG、PNG 格式
  - 文件大小不超过 2MB
  - 上传后会显示图片预览

### 4. 填写处理备注
- 可以填写处理相关的备注信息（可选）

### 5. 确认处理
- 点击"确认处理"按钮提交

## 界面效果

### 选择"开始处理"或"处理失败"时：
```
处理状态: ○ 开始处理 ○ 处理完成 ○ 处理失败
处理备注: [文本框]
```

### 选择"处理完成"时：
```
处理状态: ○ 开始处理 ● 处理完成 ○ 处理失败
交易ID: [输入框] *必填
付款凭证: [上传区域] - 支持 JPG、PNG 格式，大小不超过 2MB
处理备注: [文本框]
```

## 技术实现

### 条件渲染
```vue
<el-form-item
  v-if="processForm.status === 'completed'"
  label="付款凭证"
>
  <el-upload
    class="voucher-uploader"
    action="#"
    :show-file-list="false"
    :before-upload="beforeVoucherUpload"
    :on-success="handleVoucherSuccess"
    accept="image/*"
  >
    <img v-if="processForm.voucherUrl" :src="processForm.voucherUrl" class="voucher-image" />
    <el-icon v-else class="voucher-uploader-icon"><Plus /></el-icon>
  </el-upload>
  <div class="upload-tip">支持 JPG、PNG 格式，大小不超过 2MB</div>
</el-form-item>
```

### 上传处理逻辑
- 文件类型验证：只允许图片文件
- 文件大小验证：不超过 2MB
- 本地预览：使用 FileReader 生成预览URL
- 阻止自动上传：返回 false 阻止默认上传行为

## 测试验证

### 访问页面
1. 启动开发服务器：`npm run serve`
2. 访问：`http://localhost:8082/#/admin/withdrawal-management`
3. 点击任意提现记录的"处理"按钮

### 测试流程
1. ✅ 确认对话框正常打开
2. ✅ 默认选择"开始处理"状态
3. ✅ 切换到"处理完成"状态
4. ✅ 确认显示"交易ID"输入框
5. ✅ 确认显示"付款凭证"上传区域
6. ✅ 测试图片上传功能
7. ✅ 测试文件类型和大小验证
8. ✅ 确认图片预览功能

## 注意事项

### 用户操作提示
- **必须选择"处理完成"状态**才能看到上传功能
- 上传的图片会立即显示预览
- 交易ID在选择"处理完成"时为必填项

### 开发说明
- 上传功能已完全实现并测试通过
- 样式已优化，与整体界面风格一致
- 文件验证逻辑已实现
- 错误提示已配置

## 问题排查

如果看不到上传功能：
1. 检查是否选择了"处理完成"状态
2. 检查浏览器控制台是否有错误
3. 确认Plus图标是否正确导入
4. 检查Element Plus版本兼容性

## 功能截图说明

根据您提供的截图，对话框显示的是"开始处理"状态被选中，这时不会显示上传功能。请切换到"处理完成"状态即可看到完整的上传界面。 